---
title: "å…¨é¢å‡ç´šï¼šé‡æ–°å­¸ç¿’ React Router"
excerpt: "React Router åœ˜éšŠæœ€è¿‘åˆä¾†ä¸€æ¬¡å…¨é¢å‡ç´šï¼Œæ–°å¢äº†è¨±å¤šåŠŸèƒ½ï¼Œç‰¹åˆ¥æ˜¯ Loader åŠŸèƒ½è®“äººé©šè±”ã€‚ä»–å€‘çš„æ–‡ä»¶ä¹Ÿå¯«å¾—ç›¸ç•¶å¥½ï¼ŒåŸºæœ¬ä¸Šè·Ÿè‘—ä¸€é Tutorial å°±èƒ½æŒæ¡ React Router V6 çš„å¤§è‡´åŠŸèƒ½ã€‚"
tags: ["React", "React Router"]
date: "2023-03-01"
---

ä¸å¤šèªªï¼Œè®“æˆ‘å€‘é‡æ–°é–‹å§‹ï¼Œå°±å¾å»ºç«‹è·¯ç”±é–‹å§‹å§ â‹¯â‹¯ ( ê™¬)ğŸ¥•

## è³‡æ–™å¤¾çµæ§‹ - Folder Structure

é¦–å…ˆï¼Œä½ çš„ React å°ˆæ¡ˆæœƒæœ‰ä¸€å€‹ `src` è³‡æ–™å¤¾ï¼Œè£¡é¢çš„ `App.js(x)` æˆ– `main.js(x)` å°±æ˜¯ä½ çš„é€²å…¥é» (Entry)ã€‚

æ¥ä¸‹ä¾†ï¼Œåœ¨ `src` ä¸‹å»ºç«‹åç‚º `pages` æˆ– `routes` çš„è³‡æ–™å¤¾ï¼Œç”¨é€”æ˜¯æ”¾ç½® Page-Level Componentsã€‚

## å»ºç«‹è·¯ç”± - createBrowserRouter

åœ¨é€²å…¥é»æª”æ¡ˆä¸­ï¼Œæˆ‘å€‘éœ€è¦å®£å‘Šè·¯ç”±ã€‚é€é `createBrowserRouter()` æ–¹æ³•ï¼Œå‚³å…¥ç”±ç‰©ä»¶çµ„æˆçš„é™£åˆ—ï¼Œæ¯å€‹ç‰©ä»¶å°±æ˜¯ä¸€çµ„è·¯ç”±ï¼Œæœ€å¾ŒæŠŠå›å‚³çš„å€¼ç”¨ `router` æ¥èµ·ä¾†ï¼Œå‚³å…¥ `RouterProviderã€‚`

```javascript
import { createBrowserRouter, RouterProvider } from "react-router-dom";
import HomePage from "@/routes/Home";
import ProductsPage from "@/routes/Products";

const router = createBrowserRouter([
  { path: "/", element: <HomePage /> },
  { path: "/products", element: <ProductsPage /> },
]);

ReactDOM.createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <RouterProvider router={router} />
  </React.StrictMode>,
);
```

è£œå……ä¸€ä¸‹ï¼Œæœ‰äº›äººæœƒæŠŠé€™å€‹ `App.js(x)` åªç•¶ä½œå®£å‘Šè·¯ç”±çš„å…ƒä»¶ï¼Œå†æŠŠ `RouterProvider` åŒ¯å‡ºå»çµ¦é¡å¤–çš„é€²å…¥é»åƒæ˜¯ `index.js(x)` ä½¿ç”¨ï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ¨£çš„ï¼Œæˆ‘åªæ˜¯ä¸æƒ³è¦æœ‰é‚£éº¼å¤šæª”æ¡ˆã€‚

> è‡³æ–¼å¦ä¸€ç¨®å»ºç«‹æ–¹æ³• `createRoutesFromElement` è¼ƒç‚ºå†—é•·ï¼Œè·Ÿä»¥å‰ä½¿ç”¨ JSX çš„å¯«æ³•ç›¸ä¼¼ï¼Œé€™è£¡ä¸äºˆä»‹ç´¹ã€‚

## è·¯ç”±éˆçµ - Link èˆ‡ NavLink

åœ¨ React Router ä¸­ï¼Œè¦å¯¦ç¾é é¢è·³è½‰çš„åŠŸèƒ½ï¼Œæˆ‘å€‘ä¸¦ä¸ä½¿ç”¨åŸç”Ÿçš„ `<a>` æ¨™ç±¤ï¼Œè€Œæ˜¯ä½¿ç”¨ React Router æä¾›çš„ `<Link>` å…ƒä»¶ã€‚

```javascript
import { Link, NavLink } from "react-router-dom";
<Link to="/products">Products Page</Link>;
```

é‚„æœ‰å¦ä¸€ç¨®è·¯ç”±éˆçµæ˜¯ `<NavLink>`ï¼Œå®ƒèˆ‡ `<Link>` çš„ä½œç”¨ç›¸åŒï¼Œä½†å…§å»ºäº† `isActive` å’Œ `isPending` å…©å€‹ç‹€æ…‹å±¬æ€§ã€‚ä½ å¯ä»¥å°‡å®ƒå€‘è§£æ§‹å‡ºä¾†ï¼Œç”¨æ–¼åˆ¤æ–·ç•¶å‰è·¯ç”±çš„ç‹€æ…‹ï¼Œä¸¦å‹•æ…‹åœ°è¨­ç½®æ¨£å¼ã€‚

```javascript
const getNavLinkClass = ({ isActive, isPending }) => {
  if (isActive) {
    return "active";
  }
  if (isPending) {
    return "pending";
  }
  return "";
};

<NavLink to="/products" className={getNavLinkClass}>
  Products Page
</NavLink>;
```

åœ¨ `<NavLink>` ä½¿ç”¨ `end` å±¬æ€§ï¼Œå¯ä»¥ç¢ºä¿è©²å…ƒä»¶ä¸æœƒåœ¨é€²å…¥å­è·¯ç”±æ™‚ï¼Œè¢«åŒ¹é…ç‚º `isActive` ç­‰ç‹€æ…‹ã€‚

ä¾‹å¦‚ï¼š

- Home åªæœƒå°æ‡‰åˆ°ç¶²ç«™çš„æ ¹è·¯ç”± (`'/'`)ï¼Œä¹Ÿå°±æ˜¯å¾Œé¢ä¸å¸¶ä»»ä½•è·¯å¾‘æ™‚
- Blog åªæœƒå°æ‡‰åˆ° `/blog`ï¼Œç•¶é€²å…¥ `/blog/hello-world` é é¢æ™‚ä¸æœƒæœ‰ `isActive` ç‹€æ…‹

```javascript
<NavLink to="/" end>Home</NavLink>
<NavLink to="/blog" end>Blog</NavLink>
<NavLink to={`/blog/hello-world`}>Hello World</NavLink>
```

## å…±ç”¨å¤–æ¡† - children èˆ‡ Outlet

ä¸€å€‹ç¶²ç«™é€šå¸¸æœƒæœ‰ä¸€å€‹å…±ç”¨çš„å¤–æ¡†ï¼Œä¾‹å¦‚ä¸Šæ–¹æˆ–å·¦å´çš„å°è¦½åˆ—ã€å•†æ¨™ã€ç‰ˆæ¬Šå®£å‘Šç­‰ç­‰ï¼Œé€™äº›å…§å®¹æœƒå…¨éƒ¨æ”¾åœ¨ä¸€å€‹ Layout å…ƒä»¶ç•¶ä¸­ã€‚

åœ¨è·¯ç”±é…ç½®ä¸­ï¼Œé€™å€‹ Root Layout å…ƒä»¶å°±æ˜¯ä¸€å€‹çˆ¶è·¯ç”±ï¼Œä½¿ç”¨ `children` é…ç½®å­é é¢ï¼Œå³å­è·¯ç”±ã€‚

```javascript
const router = createBrowserRouter([
  {
    path: "/",
    element: <RootLayout />,
    children: [
      { path: "/", element: <HomePage /> },
      { path: "/products", element: <ProductsPage /> },
    ],
  },
]);
```

ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ Layout å…ƒä»¶ï¼Œå­é é¢ `children` çš„å…§å®¹æœƒé¡¯ç¤ºåœ¨ `<Outlet />` é€™å€‹è¼¸å‡ºé»çš„ä½ç½®ã€‚

```javascript
import { Outlet } from "react-router-dom";

const RootLayout = () => {
  return (
    <>
      <h1>Root Layout</h1>
      <Outlet />
    </>
  );
};

export default RootLayout;
```

## éŒ¯èª¤é é¢ - errorElement

å¦‚æœé€²å…¥ä¸€å€‹æœªå®šç¾©çš„è·¯ç”±ï¼Œé€šå¸¸æœƒé¡¯ç¤º 404 éŒ¯èª¤é é¢ï¼Œä¸Šé¢å¯èƒ½æœƒæœ‰ä¸€äº›éŒ¯èª¤è¨Šæ¯ã€‚ä½†é€šå¸¸ä½ ä¸æœƒæƒ³è¦ç›´æ¥ä½¿ç”¨ React Router å…§å»ºçš„éŒ¯èª¤é é¢ï¼Œå› æ­¤æˆ‘å€‘ä¾†å»ºç«‹è‡ªå·±çš„éŒ¯èª¤é é¢ã€‚

```javascript
import { useRouteError } from "react-router-dom";

const ErrorPage = () => {
  const error = useRouteError();
  console.error(error);

  return (
    <div id="error-page">
      <h1>Oops!</h1>
      <p>Sorry, an unexpected error has occurred.</p>
      <p>
        <i>{error.statusText || error.message}</i>
      </p>
    </div>
  );
};

export default ErrorPage;
```

å®Œæˆäº†é€™å€‹ç°¡å–®çš„ 404 é é¢å¾Œï¼Œå¯ä»¥é€é `errorElement` ä¾†é…ç½®é€™å€‹éŒ¯èª¤è™•ç†çš„å°ˆå±¬é é¢ã€‚

```javascript
const router = createBrowserRouter([
  {
    path: "/",
    element: <RootLayout />,
    errorElement: <ErrorPage />, // catch any errors
    children: [
      { path: "/", element: <HomePage /> },
      { path: "/products", element: <ProductsPage /> },
    ],
  },
]);
```

## ç¨‹å¼åŒ–å°é  - useNavigate

é™¤äº†ä½¿ç”¨ Link ä¾†æ›é ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥æ‰‹å‹•åŸ·è¡Œè·¯ç”±è·³è½‰çš„å‹•ä½œï¼Œä¾‹å¦‚åœ¨è¡¨å–®é€å‡ºæˆ–æŒ‰ä¸‹æŒ‰éˆ•å¾Œå°é ã€‚

é€é `react-router-dom` æä¾›çš„ `useNavigate` å‡½å¼ï¼Œå°±å¯ä»¥åŸ·è¡Œç¨‹å¼åŒ–å°é ã€‚

```javascript
import { useNavigate } from "react-router-dom";

const Home = ({ film }) => {
  const navigate = useNavigate();

  const handleNavigate = () => {
    navigate("/products");
  };

  return (
    <div>
      <button onClick={handleNavigate}>å‰å¾€ç”¢å“é é¢</button>
    </div>
  );
};
```
